<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>珠峰架构师成长计划</title>
    <link rel="stylesheet" type="text/css" href="../static/css/main.css">
</head>
<body>
<div class="nav">
    <div class="logo">
        
            珠峰架构师成长计划
        
    </div>
<ul><li><a href="../index.html">0.Async</a></li><li><a href="../html/0.editor.html">0.editor</a></li><li><a href="../html/0.module.html">0.module</a></li><li><a href="../html/1.ES2015.html">1.ES2015</a></li><li><a href="../html/2.Promise.html">2.Promise</a></li><li><a href="../html/3.Node.html">3.Node</a></li><li><a href="../html/4.NodeInstall.html">4.NodeInstall</a></li><li><a href="../html/5.REPL.html">5.REPL</a></li><li><a href="../html/6.NodeCore.html">6.NodeCore</a></li><li><a href="../html/7.module&amp;NPM.html">7.module&amp;NPM</a></li><li><a href="../html/8.Encoding.html">8.Encoding</a></li><li><a href="../html/9.Buffer.html">9.Buffer</a></li><li><a href="../html/10.fs.html">10.fs</a></li><li><a href="../html/11.Stream-1.html">11.Stream-1</a></li><li><a href="../html/11.Stream-2.html">11.Stream-2</a></li><li><a href="../html/11.Stream-3.html">11.Stream-3</a></li><li><a href="../html/11.Stream-4.html">11.Stream-4</a></li><li><a href="../html/12-Network-2.html">12-Network-2</a></li><li><a href="../html/12.NetWork-3.html">12.NetWork-3</a></li><li class="active"><a href="../html/12.Network-1.html">12.Network-1</a></li><li><a href="../html/13.tcp.html">13.tcp</a></li><li><a href="../html/14.http-1.html">14.http-1</a></li><li><a href="../html/14.http-2.html">14.http-2</a></li><li><a href="../html/15.compress.html">15.compress</a></li><li><a href="../html/16.crypto.html">16.crypto</a></li><li><a href="../html/17.process.html">17.process</a></li><li><a href="../html/18.yargs.html">18.yargs</a></li><li><a href="../html/19.cache.html">19.cache</a></li><li><a href="../html/20.action.html">20.action</a></li><li><a href="../html/21.https.html">21.https</a></li><li><a href="../html/22.cookie.html">22.cookie</a></li><li><a href="../html/23.session.html">23.session</a></li><li><a href="../html/24.express-1.html">24.express-1</a></li><li><a href="../html/24.express-2.html">24.express-2</a></li><li><a href="../html/24.express-3.html">24.express-3</a></li><li><a href="../html/24.express-4.html">24.express-4</a></li><li><a href="../html/25.koa-1.html">25.koa-1</a></li><li><a href="../html/26.webpack-1-basic.html">26.webpack-1-basic</a></li><li><a href="../html/26.webpack-2-optimize.html">26.webpack-2-optimize</a></li><li><a href="../html/26.webpack-3.tapable.html">26.webpack-3.tapable</a></li><li><a href="../html/26.webpack-4-AST.html">26.webpack-4-AST</a></li><li><a href="../html/26.webpack-5-source.html">26.webpack-5-source</a></li><li><a href="../html/26.webpack-6-loader.html">26.webpack-6-loader</a></li><li><a href="../html/26.webpack-7-plugin.html">26.webpack-7-plugin</a></li><li><a href="../html/26.webpack-8-hand.html">26.webpack-8-hand</a></li><li><a href="../html/27.react-1.html">27.react-1</a></li><li><a href="../html/27.react-2.html">27.react-2</a></li><li><a href="../html/27.react-3.html">27.react-3</a></li><li><a href="../html/27.react-4-immutable.html">27.react-4-immutable</a></li><li><a href="../html/27.react-5-react-dom-diff.html">27.react-5-react-dom-diff</a></li><li><a href="../html/27.react-6.html">27.react-6</a></li><li><a href="../html/28.react-mobx.html">28.react-mobx</a></li><li><a href="../html/28.redux-0.html">28.redux-0</a></li><li><a href="../html/28.redux-1.html">28.redux-1</a></li><li><a href="../html/28.redux-2-中间件.html">28.redux-2-中间件</a></li><li><a href="../html/28.redux-jwt-back.html">28.redux-jwt-back</a></li><li><a href="../html/28.redux-jwt-front.html">28.redux-jwt-front</a></li><li><a href="../html/29.mongodb-1.html">29.mongodb-1</a></li><li><a href="../html/29.mongodb-2.html">29.mongodb-2</a></li><li><a href="../html/29.mongodb-3.html">29.mongodb-3</a></li><li><a href="../html/29.mongodb-4.html">29.mongodb-4</a></li><li><a href="../html/29.mongodb-5.html">29.mongodb-5</a></li><li><a href="../html/29.mongodb-6.html">29.mongodb-6</a></li><li><a href="../html/30.cms-1-mysql.html">30.cms-1-mysql</a></li><li><a href="../html/30.cms-2-mysql.html">30.cms-2-mysql</a></li><li><a href="../html/30.cms-3-mysql.html">30.cms-3-mysql</a></li><li><a href="../html/30.cms-4-nunjucks.html">30.cms-4-nunjucks</a></li><li><a href="../html/30.cms-5-mock.html">30.cms-5-mock</a></li><li><a href="../html/30.cms-6-egg.html">30.cms-6-egg</a></li><li><a href="../html/30.cms-7-api.html">30.cms-7-api</a></li><li><a href="../html/30.cms-8-roadhog.html">30.cms-8-roadhog</a></li><li><a href="../html/30.cms-9-yaml.html">30.cms-9-yaml</a></li><li><a href="../html/30.cms-10-umi.html">30.cms-10-umi</a></li><li><a href="../html/30.cms-11-saga.html">30.cms-11-saga</a></li><li><a href="../html/30.cms-12-dva.html">30.cms-12-dva</a></li><li><a href="../html/30.cms-13-dva-ant.html">30.cms-13-dva-ant</a></li><li><a href="../html/30.cms-14-front.html">30.cms-14-front</a></li><li><a href="../html/30.cms-15-deploy.html">30.cms-15-deploy</a></li><li><a href="../html/31.dva.html">31.dva</a></li><li><a href="../html/33.redis.html">33.redis</a></li><li><a href="../html/34.unittest.html">34.unittest</a></li><li><a href="../html/35.jwt.html">35.jwt</a></li><li><a href="../html/36.websocket-1.html">36.websocket-1</a></li><li><a href="../html/36.websocket-2.html">36.websocket-2</a></li><li><a href="../html/38.chat-api-1.html">38.chat-api-1</a></li><li><a href="../html/38.chat-api-2.html">38.chat-api-2</a></li><li><a href="../html/38.chat-3.html">38.chat-3</a></li><li><a href="../html/38.chat-api-3.html">38.chat-api-3</a></li><li><a href="../html/38.chat.html">38.chat</a></li><li><a href="../html/38.chat2.html">38.chat2</a></li><li><a href="../html/38.chat2.html">38.chat2</a></li><li><a href="../html/39.crawl-0.html">39.crawl-0</a></li><li><a href="../html/39.crawl-1.html">39.crawl-1</a></li><li><a href="../html/39.crawl-2.html">39.crawl-2</a></li><li><a href="../html/40.deploy.html">40.deploy</a></li><li><a href="../html/41.safe.html">41.safe</a></li><li><a href="../html/42.test.html">42.test</a></li><li><a href="../html/43.nginx.html">43.nginx</a></li><li><a href="../html/44.enzyme.html">44.enzyme</a></li><li><a href="../html/45.docker.html">45.docker</a></li><li><a href="../html/46.elastic.html">46.elastic</a></li><li><a href="../html/47.oauth.html">47.oauth</a></li><li><a href="../html/48.wxpay.html">48.wxpay</a></li><li><a href="../html/index.html">index</a></li><li><a href="../html/51.typescript.html">51.typescript</a></li><li><a href="../html/52.UML.html">52.UML</a></li><li><a href="../html/53.design.html">53.design</a></li><li><a href="../html/index.html">index</a></li><li><a href="../html/54.linux.html">54.linux</a></li><li><a href="../html/57.ts.html">57.ts</a></li><li><a href="../html/56.react-ssr.html">56.react-ssr</a></li><li><a href="../html/58.ts_react.html">58.ts_react</a></li><li><a href="../html/59.ketang.html">59.ketang</a></li><li><a href="../html/59.ketang2.html">59.ketang2</a></li><li><a href="../html/31.saga.html">31.saga</a></li></ul></div>


<div class="warpper">

    <div class="page-toc">
        <ul><li><a href="#t01. 协议的概念和作用">1. 协议的概念和作用</a><ul><li><a href="#t11.1 服务+协议实现数据传输">1.1 服务+协议实现数据传输</a></li></ul></li><li><a href="#t22. OSI七层模型">2. OSI七层模型</a></li><li><a href="#t33. TCP/IP参考模型">3. TCP/IP参考模型</a><ul><li><a href="#t4常用协议">常用协议</a></li><li><a href="#t53.1 网络接口层">3.1 网络接口层</a><ul><li><a href="#t63.1.1 物理层">3.1.1 物理层</a></li><li><a href="#t73.1.2 数据链路层">3.1.2 数据链路层</a></li><li><a href="#t83.1.3 MAC地址">3.1.3 MAC地址</a></li></ul></li><li><a href="#t93.2 互联网层(网络层)">3.2 互联网层(网络层)</a><ul><li><a href="#t103.2.1 选址">3.2.1 选址</a></li><li><a href="#t113.2.2 路由">3.2.2 路由</a></li><li><a href="#t123.2.3 IP">3.2.3 IP</a><ul><li><a href="#t133.2.3.1 IP头部">3.2.3.1 IP头部</a></li><li><a href="#t143.2.3.2 IP地址格式">3.2.3.2 IP地址格式</a></li><li><a href="#t153.2.3.3 IP地址组成">3.2.3.3 IP地址组成</a></li><li><a href="#t163.2.3.4 IP地址表示">3.2.3.4 IP地址表示</a></li><li><a href="#t173.2.3.5 IP地址的分类">3.2.3.5 IP地址的分类</a></li><li><a href="#t183.2.3.6 公有地址和私有地址">3.2.3.6 公有地址和私有地址</a></li><li><a href="#t193.2.3.7 子网掩码">3.2.3.7 子网掩码</a></li></ul></li></ul></li><li><a href="#t203.3 传输层">3.3 传输层</a><ul><li><a href="#t213.3.1 传输层的功能">3.3.1 传输层的功能</a></li><li><a href="#t223.3.2 对可靠性要求高的上层协议，实现可靠性的保证">3.3.2 对可靠性要求高的上层协议，实现可靠性的保证</a></li><li><a href="#t233.3.3 协议分类">3.3.3 协议分类</a></li><li><a href="#t243.3.4 TCP功能">3.3.4 TCP功能</a><ul><li><a href="#t253.3.4.1 TCP数据包封装">3.3.4.1 TCP数据包封装</a></li><li><a href="#t263.2.4.2 握手和断开">3.2.4.2 握手和断开</a><ul><li><a href="#t273.2.4.2.1 三次握手">3.2.4.2.1 三次握手</a></li><li><a href="#t283.2.4.2.2 四次断开">3.2.4.2.2 四次断开</a></li><li><a href="#t293.2.4.2.3 抓包">3.2.4.2.3 抓包</a></li></ul></li></ul></li></ul></li><li><a href="#t303.4 UDP">3.4 UDP</a><ul><li><a href="#t313.4.1 UDP的封装格式">3.4.1 UDP的封装格式</a></li><li><a href="#t323.4.2 UDP的应用">3.4.2 UDP的应用</a></li><li><a href="#t333.4.3 DNS服务器">3.4.3 DNS服务器</a><ul><li><a href="#t343.4.3.1 域名">3.4.3.1 域名</a></li><li><a href="#t353.4.3.2 DNS服务器">3.4.3.2 DNS服务器</a></li><li><a href="#t363.4.3.3 查找过程">3.4.3.3 查找过程</a></li></ul></li></ul></li><li><a href="#t373.5 应用层">3.5 应用层</a><ul><li><a href="#t383.5.1 协议">3.5.1 协议</a></li><li><a href="#t393.5.2 应用层常见协议">3.5.2 应用层常见协议</a></li></ul></li><li><a href="#t403.6 案例">3.6 案例</a><ul><li><a href="#t413.6.1 发送方是从高层到低层封装数据">3.6.1 发送方是从高层到低层封装数据</a></li><li><a href="#t423.6.2 接收方是从低层到高层解封装">3.6.2 接收方是从低层到高层解封装</a></li><li><a href="#t433.6.3 真实网络环境">3.6.3 真实网络环境</a></li></ul></li></ul></li><li><a href="#t444. 附录">4. 附录</a><ul><li><a href="#t454.1 不同层中的称谓：">4.1 不同层中的称谓：</a></li><li><a href="#t464.2 IP头服务类型">4.2 IP头服务类型</a></li><li><a href="#t474.3 握手和断开">4.3 握手和断开</a></li></ul></li><li><a href="#t485. 参考">5. 参考</a></li></ul>
    </div>
    
    <div class="content markdown-body">
        <h2 id="t01. 协议的概念和作用">1. 协议的概念和作用 <a href="#t01. 协议的概念和作用"> # </a></h2>
<ul>
<li>为了让计算机能够通信，计算机需要定义通信规则，这些规则就是协议</li>
<li>规则是多种，协议也有多种</li>
<li>协议就是数据封装格式+传输</li>
</ul>
<h3 id="t11.1 服务+协议实现数据传输">1.1 服务+协议实现数据传输 <a href="#t11.1 服务+协议实现数据传输"> # </a></h3>
<ul>
<li><a href="https://baike.baidu.com/item/%E6%91%A9%E5%B0%94%E6%96%AF%E7%94%B5%E7%A0%81/1527853?fr=aladdin">摩尔斯电码</a></li>
</ul>
<h2 id="t22. OSI七层模型">2. OSI七层模型 <a href="#t22. OSI七层模型"> # </a></h2>
<p>Open System Interconnection,适用于所有的网络</p>
<ul>
<li>分工带来效能<ul>
<li><a href="http://www.360doc.com/content/17/0616/08/3404269_663547705.shtml">松江黄金大劫案</a></li>
</ul>
</li>
<li>将复杂的流程分解为几个功能相对单一的子进程</li>
<li>整个流程更加清晰，复杂问题简单化</li>
<li>更容易发现问题并针对性的解决问题<ul>
<li>应用层(Application) 提供网络与用户应用软件之间的接口服务</li>
<li>表示层(Presentation) 提供格式化的表示和转换数据服务，如加密和压缩</li>
<li>会话层(Session) 提供包括访问验证和会话管理在内的建立和维护应用之间通信的机制</li>
<li>传输层(Transimission) 提供建立、维护和取消传输连接功能，负责可靠地传输数据(PC)</li>
<li>网络层(Network) 处理网络间路由，确保数据及时传送(路由器)</li>
<li>数据链路层(DataLink) 负责无错传输数据，确认帧、发错重传等(交换机)</li>
<li>物理层(Physics) 提供机械、电气、功能和过程特性(网卡、网线、双绞线、同轴电缆、中继器)</li>
</ul>
</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/osi.png" alt="分层模型"></p>
<h2 id="t33. TCP/IP参考模型">3. TCP/IP参考模型 <a href="#t33. TCP/IP参考模型"> # </a></h2>
<ul>
<li>TCP/IP是传输控制协议/网络互联协议的简称</li>
<li>早期的TCP/IP模型是一个四层结构，从下往上依次是网络接口层、互联网层、传输层和应用层</li>
<li>后来在使用过程中，借鉴OSI七层参考模型，将网络接口层划分为了物理层和数据链路层，形成五层结构</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/tcpip.png" alt="tcpip"></p>
<h3 id="t4常用协议">常用协议 <a href="#t4常用协议"> # </a></h3>
<ul>
<li>TCP/IP协议被称为传输控制协议/互联网协议，又称网络通讯协议</li>
<li>是由网络层的IP协议和传输层的TCP协议组成，是一个很大的协议集合</li>
<li>物理层和数据链路层没有定义任何特定协议，支持所有的标准和专用的协议</li>
<li>网络层定义了网络互联也就是IP协议<ul>
<li>网际协议IP(Internet Protocal) 负责主机和网络之间寻址和路由数据包</li>
<li>地址解析协议ARP(Address Resolution Protocol) 获得同一物理网络中的硬件主机MAC地址</li>
<li>反向地址转换协议(Reverse Address Resolution Protocol) 允许局域网的物理机器从网关服务器的ARP表或者缓存上请求其IP地址</li>
<li>网际控制消息协议ICMP(Internet Control Message Protocol) 发送消息，并报告有关数据包的传送错误</li>
<li>互联组管理协议IGMP(Internet Group Management Protocol) IP主机向本地多路广播路由器报告主机组成员</li>
</ul>
</li>
<li>传输层定义了TCP(传输控制协议)和UDP(用户数据报)协议</li>
<li>应用层定义了HTTP(超文本传输协议)、FTP(文件传输协议)、DNS(域名系统)等协议</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/protocal.png" alt="分层模型"></p>
<h3 id="t53.1 网络接口层">3.1 网络接口层 <a href="#t53.1 网络接口层"> # </a></h3>
<p>网络接口层是TCP/IP模型的最底层，负责接收从上一层交来的数据报并将数据报通过底层的物理网络发送出去，比较常见的就是设备的驱动程序，此层没有特定的协议
网络接口层又分为物理层和数据链路层</p>
<h4 id="t63.1.1 物理层">3.1.1 物理层 <a href="#t63.1.1 物理层"> # </a></h4>
<p>计算机在传递数据的时候传递的都是0和1的数字，而物理层关心的是用什么信号来表示0和1，是否可以双向通信，最初的连接如何建立以及完成连接如何终止,物理层是为数据传输提供可靠的环境。</p>
<ul>
<li>为数据端设备提供传送数据的通路</li>
<li>传输数据<ul>
<li>激活物理连接，在连接的设备之间连接起来形成通路</li>
<li>传输数据,关心如何打包数据和控制传输速度</li>
<li>关闭物理连接</li>
</ul>
</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/2.phisical.png" alt="物理层"></p>
<h4 id="t73.1.2 数据链路层">3.1.2 数据链路层 <a href="#t73.1.2 数据链路层"> # </a></h4>
<p>数据链路层们于物理层和互联网层之间，用来向网络层提供数据，就是把源计算机网络层传过来的信息传递给目标主机。</p>
<ul>
<li>如何将数据组合成数据帧(Frame)，帧是数据链路层的传输单位</li>
<li>数据链路的建立、维护和拆除</li>
<li>帧包装、帧传输、帧同步</li>
<li>帧的差错恢复</li>
<li>流量控制</li>
</ul>
<h4 id="t83.1.3 MAC地址">3.1.3 MAC地址 <a href="#t83.1.3 MAC地址"> # </a></h4>
<ul>
<li>在通信过程中是用内置在网卡内的地址来标识计算机身份的</li>
<li>每个网卡都有一个全球唯一的地址来标识自己，不会重复</li>
<li>MAC地址48位的二进制组成，通常分为6段，用16进制表示</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/8.mac.png" alt="信号"></p>
<h3 id="t93.2 互联网层(网络层)">3.2 互联网层(网络层) <a href="#t93.2 互联网层(网络层)"> # </a></h3>
<ul>
<li>位于传输层和网络接口层之间,用于把数据从源主机经过若干个中间节点传送到目标主机,并向传输层提供最基础的数据传输服务,它要提供路由和选址的工作</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/8.iplayer.png" alt="网络层"></p>
<h4 id="t103.2.1 选址">3.2.1 选址 <a href="#t103.2.1 选址"> # </a></h4>
<p>交换机是靠MAC来寻址的，而因为MAC地址是无层次的,所以要靠IP地址来确认计算机的位置,这就是选址</p>
<p><img src="http://img.zhufengpeixun.cn/8.address.png" alt="网络层"></p>
<p><img src="https://p.ssl.qhimg.com/t0123c4234759d969dc.jpg" alt="信封"></p>
<h4 id="t113.2.2 路由">3.2.2 路由 <a href="#t113.2.2 路由"> # </a></h4>
<p>在能够选择的多条道路之间选择一条最短的路径就是路由的工作</p>
<p><img src="http://img.zhufengpeixun.cn/8.router.png" alt="网络层"></p>
<h4 id="t123.2.3 IP">3.2.3 IP <a href="#t123.2.3 IP"> # </a></h4>
<p>在网络中，每台计算机都有一个唯一的地址，方便别人找到它，这个地址称为IP地址。</p>
<h5 id="t133.2.3.1 IP头部">3.2.3.1 IP头部 <a href="#t133.2.3.1 IP头部"> # </a></h5>
<p><img src="http://img.zhufengpeixun.cn/ipheader.png" alt="ipheader"></p>
<ul>
<li>版本</li>
<li>首部长部</li>
<li>优先级与服务类型</li>
<li>总长度 该字段用以指示整个IP数据包的长度，最长为65535字节，包括头和数据</li>
<li>标识符 唯一标识主机发送的每一份数据报</li>
<li>标志 分为3个字段，依次为保留位、不分片位和更多片位<ul>
<li>保留位：一般被置为0</li>
<li>不分片位：表示该数据报是否被分片，如果被置为1，则不能对数据报进行分片，如果要对其进行分片处理，就应将其置为0</li>
<li>更多片位：除了最后一个分片，其他每个组成数据报的片都要将该位置设置为1.</li>
</ul>
</li>
<li>段偏移量  该分片相对于原始数据报开始处位置的偏移量</li>
<li>TTL(Time to Live生存时间) 该字段用于表示IP数据包的生命周期，可以防止一个数据包在网络中无限循环地发下去。TTL的意思是一个数据包在被丢弃之前在网络中的最大周转时间。该数据包经过的每一个路由器都会检查该字段中的值，当TTL的值为0时此数据包会被丢弃。TTL对应于一个数据包通过路由器的数目，一个数据包每经过一个路由器，TTL将减去1。</li>
<li>协议号 用以指示IP数据包中封装的是哪个协议</li>
<li>首部校验和 检验和是16位的错误检测字段。目的主机和网络中的每个网关都要重新计算报头的校验和，一样表示没有改动过.</li>
<li>源IP地址 该字段用于表示数据包的源地址，指的是发送该数据包的设备的网络地址</li>
<li>目标IP地址 该字段用于表示数据包的目标的地址，指的是接收节点的网络地址</li>
</ul>
<h5 id="t143.2.3.2 IP地址格式">3.2.3.2 IP地址格式 <a href="#t143.2.3.2 IP地址格式"> # </a></h5>
<ul>
<li>IP地址是一个网络编码，用来确定网络中的一个节点。</li>
<li>IP地址是由32位二进制(32bit)组成</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/9.ip.png" alt="IP地址"></p>
<h5 id="t153.2.3.3 IP地址组成">3.2.3.3 IP地址组成 <a href="#t153.2.3.3 IP地址组成"> # </a></h5>
<ul>
<li>网络部分(NETWORK)</li>
<li>主机部分(HOST)</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/ippart.png" alt="compose"></p>
<h5 id="t163.2.3.4 IP地址表示">3.2.3.4 IP地址表示 <a href="#t163.2.3.4 IP地址表示"> # </a></h5>
<p><img src="http://img.zhufengpeixun.cn/9.ip.png" alt="compose"></p>
<h5 id="t173.2.3.5 IP地址的分类">3.2.3.5 IP地址的分类 <a href="#t173.2.3.5 IP地址的分类"> # </a></h5>
<ul>
<li>IP地址的网络部分是由Internet地址分配机构来统一分配的，这样可以保证IP的唯一性。</li>
<li>ip地址中全为1的ip即255.255.255.255，它称为限制广播地址，如果将其作为数据包的目标地址可以理解为发送到所有网络的所有主机</li>
<li>ip地址中全为0的ip即0.0.0.0，它表示启动时的ip地址，其含义就是尚未未分配时的ip地址</li>
<li>127是用来进行本机测试的，除了127.255.255.255外，其它的127开头的地址都代表本机</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/10.ipclass.png" alt="compose"></p>
<h5 id="t183.2.3.6 公有地址和私有地址">3.2.3.6 公有地址和私有地址 <a href="#t183.2.3.6 公有地址和私有地址"> # </a></h5>
<p>私有IP</p>
<ul>
<li>A类私有IP：10.0.0.0 ~ 10.255.255.255</li>
<li>B类私有IP：172.16.0.0 ~ 172.31.255.255</li>
<li>C类私有IP：192.168.0.0 ~ 192.168.255.255</li>
</ul>
<p>其他范围的IP均为公有IP地址</p>
<h5 id="t193.2.3.7 子网掩码">3.2.3.7 子网掩码 <a href="#t193.2.3.7 子网掩码"> # </a></h5>
<p>子网掩码(subnet mask)又叫子网络遮罩，它是一种用来指明一个IP地址的哪些位标识的是主机所在的子网，以及哪些位标识的是主机位的掩码。
子网掩码不能单独存在，它必须结合IP地址一起使用。
子网掩码只有一个作用，就是将某个IP地址划分成网络地址和主机地址两部分。</p>
<ul>
<li>子网掩码也是32个二进制位</li>
<li>对应IP的网络部分用1表示</li>
<li>对应IP地址的主机部分用0表示</li>
<li>IP地址和子网掩码做逻辑与运算得到网络地址<ul>
<li>0和任何数相与都是0</li>
<li>1和任何数相与都等于任何数本身</li>
</ul>
</li>
<li>A B C 三类地址都有自己默认的子网掩码<ul>
<li>A类 255.0.0.0</li>
<li>B类 255.255.0.0</li>
<li>C类 255.255.255.0</li>
</ul>
</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/10.mask.png" alt="transfer"></p>
<h3 id="t203.3 传输层">3.3 传输层 <a href="#t203.3 传输层"> # </a></h3>
<p>位于应用层和网络接口层之间</p>
<ul>
<li>是面向连接的、可靠的的进程到进程通信的协议</li>
<li>TCP提供全双工服务，即数据可在同一时间双向传播</li>
<li>TCP将若干个字节构成一个分组，此分组称为报文段(Segment)</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/11.transfer.png" alt="transfer"></p>
<h4 id="t213.3.1 传输层的功能">3.3.1 传输层的功能 <a href="#t213.3.1 传输层的功能"> # </a></h4>
<p>提供了一种端到端的连接</p>
<p><img src="http://img.zhufengpeixun.cn/11.connect.png" alt="connect"></p>
<h4 id="t223.3.2 对可靠性要求高的上层协议，实现可靠性的保证">3.3.2 对可靠性要求高的上层协议，实现可靠性的保证 <a href="#t223.3.2 对可靠性要求高的上层协议，实现可靠性的保证"> # </a></h4>
<ul>
<li>如果数据丢失、损坏的情况下如何保证可靠性</li>
<li>网络层只管传递数据，成功与否并不关心</li>
</ul>
<h4 id="t233.3.3 协议分类">3.3.3 协议分类 <a href="#t233.3.3 协议分类"> # </a></h4>
<ul>
<li>TCP(Transimision Control Protocal)<ul>
<li>传输控制协议</li>
<li>可靠的、面向连接的协议</li>
<li>传输效率低</li>
</ul>
</li>
<li>UDP(User Datagram Protocal)<ul>
<li>用户数据报协议</li>
<li>不可靠的、无连接的服务</li>
<li>传输效率高</li>
</ul>
</li>
</ul>
<h4 id="t243.3.4 TCP功能">3.3.4 TCP功能 <a href="#t243.3.4 TCP功能"> # </a></h4>
<ul>
<li>将数据进行分段打包传输</li>
<li>对每个数据包编号控制顺序</li>
<li>运输中丢失、重发和丢弃处理</li>
<li>流量控制避免拥塞</li>
</ul>
<h5 id="t253.3.4.1 TCP数据包封装">3.3.4.1 TCP数据包封装 <a href="#t253.3.4.1 TCP数据包封装"> # </a></h5>
<p><img src="http://img.zhufengpeixun.cn/tcpport.png" alt="connect"></p>
<ul>
<li>源端口号和目标端口号，计算机通过端口号识别访问哪个服务,比如http服务或ftp服务，发送方端口号是进行随机端口，目标端口号决定了接收方哪个程序来接收
<img src="http://img.zhufengpeixun.cn/tcpsequence.png" alt="connect"></li>
<li>32位序列号 TCP用序列号对数据包进行标记，以便在到达目的地后重新重装，假设当前的序列号为 s，发送数据长度为 l，则下次发送数据时的序列号为 s + l。在建立连接时通常由计算机生成一个随机数作为序列号的初始值
<img src="http://img.zhufengpeixun.cn/tcpconfirm.png" alt="connect"></li>
<li>确认应答号 它等于下一次应该接收到的数据的序列号。假设发送端的序列号为 s，发送数据的长度为 l，那么接收端返回的确认应答号也是 s + l。发送端接收到这个确认应答后，可以认为这个位置以前所有的数据都已被正常接收。</li>
<li><p>首部长度：TCP 首部的长度，单位为 4 字节。如果没有可选字段，那么这里的值就是 5。表示 TCP 首部的长度为 20 字节。
<img src="http://img.zhufengpeixun.cn/tcpcontrolpng.png" alt="connect"></p>
</li>
<li><p>控制位 TCP的连接、传输和断开都受这六个控制位的指挥</p>
<ul>
<li>PSH(push急迫位)   缓存区将满，立刻传输速度</li>
<li>RST(reset重置位)  连接断了重新连接</li>
<li>URG(urgent紧急位) 紧急信号</li>
</ul>
</li>
<li>紧急指针：尽在 URG(urgent紧急) 控制位为 1 时有效。表示紧急数据的末尾在 TCP 数据部分中的位置。通常在暂时中断通信时使用（比如输入 Ctrl + C）。</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/tcpack.png" alt="tcpack"></p>
<ul>
<li>ACK(acknowledgement 确认)为1表示确认号
<img src="http://img.zhufengpeixun.cn/tcpsyn.png" alt="tcpsyn"></li>
<li>SYN(synchronous建立联机) 同步序号位 TCP建立连接时要将这个值设为1
<img src="http://img.zhufengpeixun.cn/tcpfin.png" alt="tcpfin"></li>
<li>FIN发送端完成位，提出断开连接的一方把FIN置为1表示要断开连接
<img src="http://img.zhufengpeixun.cn/tcpwindow.png" alt="tcpwindow"></li>
<li>窗口值 说明本地可接收数据段的数目，这个值的大小是可变的。当网络通畅时将这个窗口值变大加快传输速度，当网络不稳定时减少这个值可以保证网络数据的可靠传输。它是来在TCP传输中进行流量控制的</li>
<li>窗口大小：用于表示从应答号开始能够接受多少个 8 位字节。如果窗口大小为 0，可以发送窗口探测。
<img src="http://img.zhufengpeixun.cn/tcpcheck.png" alt="connect"></li>
<li>用来做差错控制，TCP校验和的计算包括TCP首部、数据和其它填充字节。在发送TCP数据段时，由发送端计算校验和，当到达目的地时又进行一次检验和计算。如果两次校验 和一致说明数据是正确的，否则 将认为数据被破坏，接收端将丢弃该数据</li>
</ul>
<h5 id="t263.2.4.2 握手和断开">3.2.4.2 握手和断开 <a href="#t263.2.4.2 握手和断开"> # </a></h5>
<ul>
<li>TCP是面向连接的协议，它在源点和终点之间建立虚拟连接，而不是物理连接</li>
<li>在数据通信之前，发送端与接收端要先建立连接，等数据发送结束后，双方再断开连接</li>
<li>TCP连接的每一方都是由一个IP地址和一个端口组成</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/sequencenumber.jpg" alt="sequencenumber"></p>
<h6 id="t273.2.4.2.1 三次握手">3.2.4.2.1 三次握手 <a href="#t273.2.4.2.1 三次握手"> # </a></h6>
<ul>
<li>第一次握手主机A通过一个标识为SYN标识位的数据段发送给主机B请求连接，通过该数据段告诉主机B希望建立连接，需要B应答，并告诉主机B传输的起始序列号</li>
<li>第二次握手是主机B用一个确认应答ACK和同步序列号SYNC标志位的数据段来响应主机A，一是发送ACK告诉主机A收到了数据段，二是通知主机A从哪个序列号做标记。</li>
<li>第三次握手是主机A确认收到了主机B的数据段并可以开始传输实际数据。</li>
</ul>
<h6 id="t283.2.4.2.2 四次断开">3.2.4.2.2 四次断开 <a href="#t283.2.4.2.2 四次断开"> # </a></h6>
<ul>
<li>主机A发送FIN控制位发出断开连接的请求</li>
<li>主机B进行响应，确认收到断开连接请求</li>
<li>主机B提出反方向的关闭要求</li>
<li>主机A确认收到的主机B的关闭连接请求</li>
</ul>
<h6 id="t293.2.4.2.3 抓包">3.2.4.2.3 抓包 <a href="#t293.2.4.2.3 抓包"> # </a></h6>
<p><img src="http://img.zhufengpeixun.cn/seqpre.png" alt="sequencenumber"></p>
<h3 id="t303.4 UDP">3.4 UDP <a href="#t303.4 UDP"> # </a></h3>
<ul>
<li>UDP是一个无连接、不保证可靠性的传输层协议，也就是说发送端不关心发送的数据是否到达目标主机、数据是否出错等，收到数据的主机也不会告诉 发送方是否收到了数据，它的可靠性由上层协议来保障</li>
<li>首部结构简单，在数据传输时能实现最小的开销，如果进程想发送很短的报文而对可靠性要求不高可以使用</li>
</ul>
<h4 id="t313.4.1 UDP的封装格式">3.4.1 UDP的封装格式 <a href="#t313.4.1 UDP的封装格式"> # </a></h4>
<p><img src="http://img.zhufengpeixun.cn/15.udp.png" alt="connect"></p>
<p><img src="http://img.zhufengpeixun.cn/udplength.png" alt="connect"></p>
<p><img src="http://img.zhufengpeixun.cn/udpcheck.png" alt="connect"></p>
<h4 id="t323.4.2 UDP的应用">3.4.2 UDP的应用 <a href="#t323.4.2 UDP的应用"> # </a></h4>
<ul>
<li>QQ</li>
<li>视频软件</li>
<li>TFTP 简单文件传输协议(短信)</li>
</ul>
<h4 id="t333.4.3 DNS服务器">3.4.3 DNS服务器 <a href="#t333.4.3 DNS服务器"> # </a></h4>
<h5 id="t343.4.3.1 域名">3.4.3.1 域名 <a href="#t343.4.3.1 域名"> # </a></h5>
<ul>
<li>域名空间结构</li>
<li>根域</li>
<li>顶级域<ul>
<li>组织域</li>
<li>国家/地区域名</li>
</ul>
</li>
<li>二级域名</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/arealocal.png" alt="域名"></p>
<h5 id="t353.4.3.2 DNS服务器">3.4.3.2 DNS服务器 <a href="#t353.4.3.2 DNS服务器"> # </a></h5>
<p>DNS是Domain Name Service的缩写，DNS服务器进行域名和与之对应的IP地址转换的服务器</p>
<ul>
<li>IP地址不易记忆</li>
<li>早期使用Hosts文件解析域名<ul>
<li>主要名称重复</li>
<li>主机维护困难</li>
</ul>
</li>
<li>DNS(Domain Name System 域名系统)<ul>
<li>分布式</li>
<li>层次性</li>
</ul>
</li>
</ul>
<h5 id="t363.4.3.3 查找过程">3.4.3.3 查找过程 <a href="#t363.4.3.3 查找过程"> # </a></h5>
<p><img src="http://img.zhufengpeixun.cn/dnsquery.jpg" alt="dns"></p>
<ul>
<li>客户端向本地域名服务器发出请求，我要访问<a href="http://www.163.com，请告诉我它的IP地址">www.163.com，请告诉我它的IP地址</a></li>
<li>本地DNS服务器向DNS根服务器发出请求，根DNS服务器会告诉本地服务器(.com)的服务器地址</li>
<li>本地DNS服务器会向(.com域)发请求，会得到(163.com)的服务器地址</li>
<li>本地DNS服务器会向(163.com)发请求,会得到(<a href="http://www.163.com)的IP地址1.1.1.1">www.163.com)的IP地址1.1.1.1</a></li>
<li>本地DNS服务器向客户端回复域名(<a href="http://www.163.com)对应的IP地址是1.1.1.1">www.163.com)对应的IP地址是1.1.1.1</a></li>
</ul>
<h3 id="t373.5 应用层">3.5 应用层 <a href="#t373.5 应用层"> # </a></h3>
<h4 id="t383.5.1 协议">3.5.1 协议 <a href="#t383.5.1 协议"> # </a></h4>
<p><img src="http://img.zhufengpeixun.cn/17.mail.png" alt="connect"></p>
<h4 id="t393.5.2 应用层常见协议">3.5.2 应用层常见协议 <a href="#t393.5.2 应用层常见协议"> # </a></h4>
<ul>
<li>HTTP 超文件传输协议</li>
<li>FTP 文件传输协议</li>
<li>SMTP(发送邮件)和POP3(接收邮件)</li>
</ul>
<h3 id="t403.6 案例">3.6 案例 <a href="#t403.6 案例"> # </a></h3>
<p>数据-&gt;传输层(包)-&gt;网络层(段Segment)-&gt;数据链路层(帧)</p>
<h4 id="t413.6.1 发送方是从高层到低层封装数据">3.6.1 发送方是从高层到低层封装数据 <a href="#t413.6.1 发送方是从高层到低层封装数据"> # </a></h4>
<ul>
<li>在应用层要把各式各样的数据如字母、数字、汉字、图片等转换成二进制</li>
<li>在TCP传输层中，上层的数据被分割成小的数据段，并为每个分段后的数据封装TCP报文头部</li>
<li>在TCP头部有一个关键的字段信息端口号，它用于标识上层的协议或应用程序，确保上层数据的正常通信</li>
<li>计算机可以多进程并发运行，例如在发邮件的同时也可以通过浏览器浏览网页，这两种应用通过端口号进行区分</li>
<li>在网络层，上层数据被封装上亲的报文头部(IP头部)，上层的数据是包括TCP头部的。IP地址包括的最关键字段信息就是IP地址，用于标识网络的逻辑地址。</li>
<li>数据链路径层，上层数据成一个MAC头部，内部有最关键的是MAC地址。MAC地址就是固化在硬件设备内部的全球唯一的物理地址。</li>
<li>在物理层，无论在之前哪一层封装的报文头和还是上层数据都是由二进制组成的，物理将这些二进制数字比特流转换成电信号在网络中传输</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/18.send.png" alt="connect"></p>
<h4 id="t423.6.2 接收方是从低层到高层解封装">3.6.2 接收方是从低层到高层解封装 <a href="#t423.6.2 接收方是从低层到高层解封装"> # </a></h4>
<ul>
<li>数据封装完毕传输到接收方后，将数据要进行解封装</li>
<li>在物理层，先把电信号转成二进制数据，并将数据传送至数据链路层</li>
<li>在数据链路层，把MAC头部拆掉，并将剩余的数据传送至上一层</li>
<li>在网络层，数据的IP头部被拆掉，并将剩余的数据送至上一层</li>
<li>在传输层，把TCP头部拆掉，将真实的数据传送至应用层</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/19.receive.png" alt="connect"></p>
<h4 id="t433.6.3 真实网络环境">3.6.3 真实网络环境 <a href="#t433.6.3 真实网络环境"> # </a></h4>
<ul>
<li>发送方和接收方中间可能会有多个硬件中转设备</li>
<li>中间可能会增加交换机和路由器</li>
<li>数据在传输过程中不断地进行封装和解封装的过程，每层设备只能处理哪一层的数据<ul>
<li>交换机属于数据链路层</li>
<li>路由器属于网络层</li>
</ul>
</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/reaenv2.png" alt="分层模型"></p>
<h2 id="t444. 附录">4. 附录 <a href="#t444. 附录"> # </a></h2>
<h3 id="t454.1 不同层中的称谓：">4.1 不同层中的称谓： <a href="#t454.1 不同层中的称谓："> # </a></h3>
<ul>
<li>数据帧（Frame）：是一种信息单位，它的起始点和目的点都是<strong>数据链路层</strong>。</li>
<li>数据包（Packet）：也是一种信息单位，它的起始和目的地是<strong>网络层</strong>。</li>
<li>段（Segment）：通常是指起始点和目的地都是<strong>传输层</strong>的信息单元。</li>
<li>消息（message）：是指起始点和目的地都在网络层以上（经常在<strong>应用层</strong>）的信息单元。</li>
</ul>
<h3 id="t464.2 IP头服务类型">4.2 IP头服务类型 <a href="#t464.2 IP头服务类型"> # </a></h3>
<ul>
<li>IP首部中的服务类型（TOS）</li>
<li>TOS包括共8位，包括3 bit的优先权字段（取值可以从000-111所有值），4 bit的TOS子字段和1 bit未用位但必须置0。</li>
<li>3bit的8个优先级的定义如下：<ul>
<li>111--Network Control(网络控制）一般保留给网络控制数据使用，如路由。</li>
<li>110--Internetwork Control(网间控制)</li>
<li>101--Critic(关键)语音数据使用。</li>
<li>100--Flash Override(疾速)视频会议和视频流使用。</li>
<li>011--Flash(闪速)语音控制数据使用。</li>
<li>010--Immediate(快速)数据业务使用</li>
<li>001--Priority(优先)数据业务使用</li>
<li>000--Routine(普通)默认标记值。</li>
</ul>
</li>
<li>4 bit的TOS分别代表：最小时延、最大吞吐量、最高可靠性和最小费用。4 bit中只能置其中1 bit。如果所有4 bit均为0，那么就意味着是一般服务。</li>
<li>Telnet、Rlogin这两个交互应用要求最小的传输时延，FTP文件传输要求最大吞吐量，最高可靠性是指网络管理（SNMP）和路由选择协议。用户网络新闻要求最小费用</li>
</ul>
<h3 id="t474.3 握手和断开">4.3 握手和断开 <a href="#t474.3 握手和断开"> # </a></h3>
<p><img src="http://img.zhufengpeixun.cn/tcp_hand_shake_detail.png" alt="sequencenumber"></p>
<p><img src="http://img.zhufengpeixun.cn/handshake.gif" alt="sequencenumber"></p>
<p><img src="http://img.zhufengpeixun.cn/tcp_head.png" alt="sequencenumber"></p>
<h2 id="t485. 参考">5. 参考 <a href="#t485. 参考"> # </a></h2>
<ul>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzAxOTc0NzExNg==&amp;mid=2665513094&amp;idx=1&amp;sn=a2accfc41107ac08d74ec3317995955e#rd">TCP/IP 之 大明王朝邮差</a></li>
</ul>

        <div class="copyright">Powered by <a href="https://github.com/jaywcjlove/idoc" target="_blank">idoc</a>. Dependence <a href="https://nodejs.org">Node.js</a> run.</div>
    </div>
    
</div>

<script src="https://cdn.bootcss.com/jquery/3.0.0/jquery.js"></script>
<script>
$('.warpper .page-toc ul ul li a').on('click',function(){
  $('.warpper .page-toc ul ul li a').removeClass('my-active')
  $(this).addClass('my-active')
})
  // if (!$('.understand-me').length) {
  //   var bar = $(window).height() - $('.navbar ').height() - $('.page-toc').position().top;
  //   var count = bar / 26 / 2;
  //   var barHeight = $('.page-toc').outerHeight();
  //   $('.page-toc li').eq(0).children('a').addClass('red');
  //   var arr = [];
  //   $("h1,h2,h3,h4,h5,h6").each(function () {
  //     arr.push($(this).position().top);
  //   });
  //   var timer
  //   function dark() {
  //     clearTimeout(timer)
  //      timer = setTimeout(function () {
  //      var top = Math.abs($('.page-toc > ul').position().top);
  //      var cur = $('.content').scrollTop();
  //      for (var i = arr.length; i >= 0; i--) {
  //        if (arr[i] <= cur) {
  //          break;
  //        }
  //      }
  //      if (i === -1) {
  //        i = 0;
  //      }
  //      $('.page-toc li a').removeClass('red');
  //      $('.page-toc li').eq(i).children('a').addClass('red');
  //      let height = $('.page-toc li').eq(i).position().top-$('.page-toc').height(); // 如果当前的offset出去了 回到中间可好？
  //      $('.page-toc').scrollTop(height+$('.page-toc').height()/2);
  //    },200)
  //   }

  //   $('.content').on('scroll', dark);
  // }
</script>
<style>

    /* ::-webkit-scrollbar{width:14px;}
    ::-webkit-scrollbar-track{background-color:transparent;}
    ::-webkit-scrollbar-thumb{background-color:transparent;}
    ::-webkit-scrollbar-thumb:hover {background-color:transparent}
    ::-webkit-scrollbar-thumb:active {background-color:transparent} */

    .page-toc > ul .red {
        background: #f3f3f3;
        z-index: 1;
        border-left: 3px solid #009a61;
        -webkit-transition: all .2s ease;
        transition: all .2s ease;
        color: #000
    }





</style>


</body></html>